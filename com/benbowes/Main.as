package com.benbowes{  	import flash.net.*;	import flash.system.*;	import flash.display.*;	import flash.events.*;	import flash.utils.getDefinitionByName;	import flash.utils.Timer;	import br.com.stimuli.loading.BulkLoader;	import br.com.stimuli.loading.BulkProgressEvent;	import com.benbowes.Global;	import com.greensock.*;	import com.greensock.easing.*;	public class Main extends MovieClip {		private var SCOPE;		private var NAVIGATION;  		private var HOME;		public var MAIN_CONTENT_HOLDER;		private var bulkLoader:BulkLoader;		public function Main () {			Security.allowDomain ("*");			Security.allowInsecureDomain ("*");			try{				stage.align = "TL";				stage.scaleMode = "noScale";			}catch(e){}			SCOPE = this;						if(Global.FLASHVARS.baseUrl == undefined){      // this should have been passed through via shell.swf 				Global.FLASHVARS.baseUrl = "";			}			SCOPE.addEventListener (Event.REMOVED_FROM_STAGE,kill,false,0,true);			SCOPE.addEventListener (Event.ADDED_TO_STAGE,loadXML,false,0,true);			SCOPE.alpha = 0;		}				private function loadXML(e:Event){     						SCOPE.mainContentHolder.x = -stage.stageWidth;						// fade stage to 0			// TweenMax.to (SCOPE,0,{tint:0x999999, ease:Quint.easeInOut});			// load XML			bulkLoader = new BulkLoader("MAIN-LOADER");			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/navigation.xml");			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/gallery.xml");			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/renders.xml");         			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/illuraLifestyle.xml"); 			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/westMelbourne.xml");			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/residence.xml"); 			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/projectTeam.xml");			bulkLoader.add(Global.FLASHVARS.baseUrl + "xml/map.xml");       						bulkLoader.addEventListener(BulkLoader.COMPLETE, parseXML, false, 0, true);			bulkLoader.start();		}				private function parseXML(e:Event):void {			// trace("XML Loaded");			Global.FLASHVARS.navigationXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/navigation.xml");			Global.FLASHVARS.galleryXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/gallery.xml");			Global.FLASHVARS.rendersXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/renders.xml"); 			Global.FLASHVARS.illuraLifestyleXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/illuraLifestyle.xml");			Global.FLASHVARS.westMelbourneXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/westMelbourne.xml");			Global.FLASHVARS.residenceXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/residence.xml");			Global.FLASHVARS.projectTeamXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/projectTeam.xml"); 			Global.FLASHVARS.mapXML = BulkLoader.getLoader("MAIN-LOADER").getXML(Global.FLASHVARS.baseUrl + "xml/map.xml"); 			init();		}		private function init () {			stage.addEventListener (Event.RESIZE, positionElements, false, 0, true);			TweenMax.to (SCOPE,0,{alpha:0, delay:1, onComplete:animateIn});		}					private function animateIn(){			// Fade in Whole MAIN stage			TweenMax.to (SCOPE,1,{alpha:1, ease:Quint.easeInOut});									MAIN_CONTENT_HOLDER = SCOPE.mainContentHolder;   						// ADD NAVIGATION CLIP TO THE STAGE - this will also load the first content according to SWFADDRESS value.		    NAVIGATION = MAIN_CONTENT_HOLDER.addChild(new com.benbowes.Navigation());		 	NAVIGATION.x = 500;		    NAVIGATION.y = 100;                                                              	HOME = SCOPE.addChild(new com.benbowes.PageHome());			HOME.name = "home";						positionElements();                                                   		}				private function positionElements(e:Event = null){			var w=stage.stageWidth;			var h=stage.stageHeight;			if(Global.FLASHVARS.homeHidden == true){				HOME.x = w; 			}     else{				MAIN_CONTENT_HOLDER.x = -w;   			}		}				private function kill (e:Event) {			SCOPE.removeEventListener (Event.ADDED_TO_STAGE,init);			SCOPE.removeEventListener (Event.REMOVED_FROM_STAGE,kill);		}	}}